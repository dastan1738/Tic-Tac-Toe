<!doctype html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏</title>
  <style>
    :root{
      --bg:#0b1220;
      --card:#0f1b33;
      --text:#eaf0ff;
      --muted:#9fb1d6;
      --line:#243a66;
      --accent:#7aa7ff;
      --good:#7dffb2;
      --bad:#ff7d9b;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      min-height:100vh;
      display:flex;
      justify-content:center;
      align-items:center;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: radial-gradient(1200px 700px at 20% 10%, #142750 0%, rgba(20,39,80,0) 60%),
                  radial-gradient(900px 600px at 90% 20%, #1b2f67 0%, rgba(27,47,103,0) 55%),
                  var(--bg);
      color:var(--text);
      padding:20px;
    }
    .app{
      width:min(520px, 100%);
      background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.03));
      border:1px solid rgba(255,255,255,0.10);
      border-radius:22px;
      box-shadow: 0 16px 50px rgba(0,0,0,0.45);
      padding:18px;
      backdrop-filter: blur(10px);
    }
    header{
      display:flex;
      gap:12px;
      justify-content:space-between;
      align-items:flex-start;
      margin-bottom:14px;
    }
    h1{
      font-size:18px;
      margin:0;
      letter-spacing:0.2px;
    }
    .sub{
      margin-top:6px;
      color:var(--muted);
      font-size:13px;
      line-height:1.25;
    }
    .pill{
      display:flex;
      gap:8px;
      align-items:center;
      padding:10px 12px;
      background: rgba(15,27,51,0.70);
      border:1px solid rgba(255,255,255,0.10);
      border-radius:14px;
      min-width: 170px;
      justify-content:space-between;
    }
    .turn{
      font-weight:700;
      color:var(--accent);
    }
    .board{
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:10px;
      padding:10px;
      background: rgba(15,27,51,0.65);
      border:1px solid rgba(255,255,255,0.10);
      border-radius:18px;
    }
    .cell{
      aspect-ratio: 1/1;
      width:100%;
      border-radius:16px;
      border:1px solid rgba(255,255,255,0.12);
      background: radial-gradient(120px 120px at 30% 30%, rgba(122,167,255,0.18), rgba(0,0,0,0));
      box-shadow: inset 0 0 0 1px rgba(0,0,0,0.15);
      display:flex;
      align-items:center;
      justify-content:center;
      font-size: clamp(40px, 8vw, 64px);
      font-weight:900;
      color: var(--text);
      cursor:pointer;
      transition: transform .12s ease, background .2s ease, border-color .2s ease;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
    }
    .cell:hover{ transform: translateY(-1px); border-color: rgba(122,167,255,0.35); }
    .cell:active{ transform: translateY(0px) scale(0.99); }
    .cell[disabled]{ cursor:not-allowed; opacity:0.85; }
    .cell.x{ color: #a7c5ff; }
    .cell.o{ color: #9fffd3; }
    .cell.win{
      border-color: rgba(125,255,178,0.55);
      box-shadow: 0 0 0 3px rgba(125,255,178,0.12), inset 0 0 0 1px rgba(0,0,0,0.2);
      background: radial-gradient(140px 140px at 30% 30%, rgba(125,255,178,0.25), rgba(0,0,0,0));
      transform: translateY(-1px);
    }
    .row{
      display:flex;
      gap:10px;
      margin-top:12px;
      flex-wrap:wrap;
      justify-content:space-between;
      align-items:center;
    }
    .status{
      flex: 1 1 260px;
      padding:12px 14px;
      background: rgba(15,27,51,0.60);
      border:1px solid rgba(255,255,255,0.10);
      border-radius:16px;
      color:var(--muted);
      font-size:13px;
      line-height:1.35;
    }
    .status b{ color: var(--text); }
    .controls{
      display:flex;
      gap:10px;
      flex: 0 0 auto;
    }
    button{
      border:0;
      padding:12px 14px;
      border-radius:14px;
      cursor:pointer;
      color:var(--text);
      font-weight:700;
      background: rgba(122,167,255,0.18);
      border:1px solid rgba(122,167,255,0.30);
      transition: transform .12s ease, background .2s ease;
      -webkit-tap-highlight-color: transparent;
    }
    button:hover{ background: rgba(122,167,255,0.24); }
    button:active{ transform: scale(0.98); }
    .danger{
      background: rgba(255,125,155,0.14);
      border-color: rgba(255,125,155,0.28);
    }
    .danger:hover{ background: rgba(255,125,155,0.20); }
    .score{
      margin-top:12px;
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:10px;
    }
    .score .box{
      padding:10px 12px;
      border-radius:16px;
      background: rgba(15,27,51,0.55);
      border:1px solid rgba(255,255,255,0.10);
      color:var(--muted);
      font-size:13px;
      display:flex;
      justify-content:space-between;
      align-items:center;
    }
    .score .box span{ color: var(--text); font-weight:800; }
    footer{
      margin-top:10px;
      color:rgba(234,240,255,0.55);
      font-size:12px;
      text-align:center;
    }
  </style>
</head>

<body>
  <div class="app">
    <header>
      <div>
        <h1>–ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏</h1>
        <div class="sub">–ò–≥—Ä–∞–π –≤–¥–≤–æ—ë–º –Ω–∞ –æ–¥–Ω–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ. –ü–æ–±–µ–¥–∞ ‚Äî 3 –≤ —Ä—è–¥.</div>
      </div>
      <div class="pill">
        <div style="color:var(--muted); font-size:12px;">–•–æ–¥</div>
        <div class="turn" id="turn">X</div>
      </div>
    </header>

    <div class="board" id="board" aria-label="–ò–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ">
      <!-- –∫–ª–µ—Ç–∫–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è JS -->
    </div>

    <div class="row">
      <div class="status" id="status">
        –ù–∞–∂–º–∏ –Ω–∞ –∫–ª–µ—Ç–∫—É, —á—Ç–æ–±—ã –ø–æ—Å—Ç–∞–≤–∏—Ç—å <b>X</b>.
      </div>
      <div class="controls">
        <button id="restart">–ó–∞–Ω–æ–≤–æ</button>
        <button class="danger" id="resetScore">–°–±—Ä–æ—Å —Å—á—ë—Ç–∞</button>
      </div>
    </div>

    <div class="score" aria-label="–°—á—ë—Ç">
      <div class="box">X: <span id="sx">0</span></div>
      <div class="box">–ù–∏—á—å—è: <span id="sd">0</span></div>
      <div class="box">O: <span id="so">0</span></div>
    </div>

    <footer>–ú–æ–∂–Ω–æ –æ—Ç–∫—Ä—ã—Ç—å –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ: –ø—Ä–æ—Å—Ç–æ —Å–æ—Ö—Ä–∞–Ω–∏ —Ñ–∞–π–ª –∏ –∑–∞–ø—É—Å—Ç–∏ –≤ –±—Ä–∞—É–∑–µ—Ä–µ.</footer>
  </div>

  <script>
    const boardEl = document.getElementById('board');
    const turnEl  = document.getElementById('turn');
    const statusEl= document.getElementById('status');
    const btnRestart = document.getElementById('restart');
    const btnResetScore = document.getElementById('resetScore');

    const sxEl = document.getElementById('sx');
    const soEl = document.getElementById('so');
    const sdEl = document.getElementById('sd');

    const WINS = [
      [0,1,2],[3,4,5],[6,7,8],
      [0,3,6],[1,4,7],[2,5,8],
      [0,4,8],[2,4,6]
    ];

    let cells = Array(9).fill("");
    let turn = "X";
    let gameOver = false;

    let score = { X:0, O:0, D:0 };

    function loadScore(){
      try{
        const saved = JSON.parse(localStorage.getItem('ttt_score') || "null");
        if(saved && typeof saved === "object"){
          score = { X: saved.X||0, O: saved.O||0, D: saved.D||0 };
        }
      }catch(e){}
      renderScore();
    }

    function saveScore(){
      localStorage.setItem('ttt_score', JSON.stringify(score));
    }

    function renderScore(){
      sxEl.textContent = score.X;
      soEl.textContent = score.O;
      sdEl.textContent = score.D;
    }

    function setStatus(text){
      statusEl.innerHTML = text;
    }

    function renderBoard(){
      boardEl.innerHTML = "";
      for(let i=0;i<9;i++){
        const btn = document.createElement('button');
        btn.className = "cell";
        btn.type = "button";
        btn.setAttribute('aria-label', `–ö–ª–µ—Ç–∫–∞ ${i+1}`);

        const v = cells[i];
        btn.textContent = v;
        if(v === "X") btn.classList.add("x");
        if(v === "O") btn.classList.add("o");

        if(gameOver || v !== "") btn.disabled = true;

        btn.addEventListener('click', () => move(i));
        boardEl.appendChild(btn);
      }
    }

    function checkWinner(){
      for(const line of WINS){
        const [a,b,c] = line;
        if(cells[a] && cells[a] === cells[b] && cells[a] === cells[c]){
          return { winner: cells[a], line };
        }
      }
      if(cells.every(v => v !== "")) return { winner: "D", line: null };
      return null;
    }

    function highlightWin(line){
      if(!line) return;
      const buttons = boardEl.querySelectorAll('.cell');
      line.forEach(i => buttons[i].classList.add('win'));
    }

    function move(i){
      if(gameOver) return;
      if(cells[i] !== "") return;

      cells[i] = turn;

      const result = checkWinner();
      if(result){
        gameOver = true;
        if(result.winner === "D"){
          score.D++;
          setStatus(`–ù–∏—á—å—è ü§ù –ù–∞–∂–º–∏ <b>–ó–∞–Ω–æ–≤–æ</b>, —á—Ç–æ–±—ã —Å—ã–≥—Ä–∞—Ç—å –µ—â—ë.`);
        } else {
          score[result.winner]++;
          setStatus(`–ü–æ–±–µ–¥–∏–ª <b>${result.winner}</b> ‚úÖ –ù–∞–∂–º–∏ <b>–ó–∞–Ω–æ–≤–æ</b>, —á—Ç–æ–±—ã —Å—ã–≥—Ä–∞—Ç—å –µ—â—ë.`);
        }
        saveScore();
        renderScore();

        renderBoard();           // —á—Ç–æ–±—ã –∑–∞–¥–∏–∑–µ–π–±–ª–∏—Ç—å –∫–Ω–æ–ø–∫–∏
        highlightWin(result.line);
        return;
      }

      turn = (turn === "X") ? "O" : "X";
      turnEl.textContent = turn;
      setStatus(`–•–æ–¥: <b>${turn}</b>`);
      renderBoard();
    }

    function restart(){
      cells = Array(9).fill("");
      turn = "X";
      gameOver = false;
      turnEl.textContent = turn;
      setStatus(`–ù–∞–∂–º–∏ –Ω–∞ –∫–ª–µ—Ç–∫—É, —á—Ç–æ–±—ã –ø–æ—Å—Ç–∞–≤–∏—Ç—å <b>X</b>.`);
      renderBoard();
    }

    btnRestart.addEventListener('click', restart);

    btnResetScore.addEventListener('click', () => {
      score = { X:0, O:0, D:0 };
      saveScore();
      renderScore();
      setStatus(`–°—á—ë—Ç —Å–±—Ä–æ—à–µ–Ω. –•–æ–¥–∏—Ç <b>${turn}</b>.`);
    });

    // —Å—Ç–∞—Ä—Ç
    loadScore();
    renderBoard();
  </script>
</body>
</html>